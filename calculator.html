<div id="calculatorModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="calculator-title">
    <div class="modal-content calculator-modern" role="document">
        <button id="calculator-close" class="close" aria-label="Close">&times;</button>

        <header class="calculator-header">
            <div>
                <h2 id="calculator-title">Website Cost Calculator</h2>
                <p class="muted">Quick estimate — not a final quote. Final pricing follows a consultation.</p>
            </div>
            <div class="calc-toolbar">
                <label class="live-toggle" title="Toggle live updates">
                    <input type="checkbox" id="calc-live" checked>
                    <span class="switch" aria-hidden="true"></span>
                    <span class="label">Live update</span>
                </label>
                <button type="button" id="calculator-reset" class="btn btn-secondary btn-reset">Reset</button>
            </div>
        </header>

            <!-- Step progress -->
        <div class="progress-bar" aria-hidden="false">
            <div class="progress-bar-line" aria-hidden="true"><div class="progress-fill" aria-hidden="true"></div></div>
            <div class="progress-bar-step"><span>1</span><p>Type</p></div>
            <div class="progress-bar-step"><span>2</span><p>Pages</p></div>
            <div class="progress-bar-step"><span>3</span><p>Features</p></div>
            <div class="progress-bar-step"><span>4</span><p>Options</p></div>
            <div class="progress-bar-step"><span>5</span><p>Quote</p></div>
        </div>

            <!-- Always-visible summary badges (sticky on desktop) -->
            <div class="result-badges sticky-badges" aria-live="polite">
                <span id="rb-type" class="rb-chip">Type: —</span>
                <span id="rb-pages" class="rb-chip">Pages: —</span>
                <span id="rb-features" class="rb-chip">Features: 0</span>
                <span id="rb-maint" class="rb-chip">Maint.: none</span>
                <span id="rb-discount" class="rb-chip rb-accent" hidden>Discount applied</span>
                <span id="rb-total" class="rb-chip" title="Estimated total">Total: —</span>
            </div>

        <div class="calculator-body">
            <form id="calculator-form" autocomplete="on">
                <!-- STEP 1: Type -->
                <section class="calculator-step active" id="step-type" aria-labelledby="lbl-type">
                    <div class="form-group" id="sec-type">
                        <label id="lbl-type" for="website-type">Type of Website</label>
                        <select id="website-type" name="website-type">
                            <option value="basic" selected>Basic — small brochure</option>
                            <option value="portfolio">Portfolio</option>
                            <option value="blog">Blog / Content site</option>
                            <option value="ecommerce">E‑commerce</option>
                            <option value="custom">Fully custom</option>
                        </select>
                    </div>
                </section>

                <!-- STEP 2: Pages -->
                <section class="calculator-step" id="step-pages" aria-labelledby="lbl-pages">
                    <div class="form-group" id="sec-pages">
                        <label id="lbl-pages" for="pages">Estimated number of pages</label>
                        <div class="range-row">
                            <input type="range" id="pages" name="pages" min="1" max="50" value="1" aria-describedby="pages-help" oninput="this.nextElementSibling.value = this.value">
                            <output>1</output>
                        </div>
                        <p class="muted" id="pages-help">More pages typically increase cost — the slider adjusts the estimate.</p>
                    </div>
                </section>

                <!-- STEP 3: Features -->
                <section class="calculator-step" id="step-features" aria-labelledby="lbl-features">
                    <div class="form-group" id="sec-features">
                        <label id="lbl-features">Additional features</label>
                        <div class="feature-grid">
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="seo">
                                <span class="pill-label">SEO</span>
                                <span class="feature-desc">On‑page SEO setup and basic keyword optimization.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="responsive" checked>
                                <span class="pill-label">Responsive Design</span>
                                <span class="feature-desc">Mobile‑friendly layout and breakpoints for all devices.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="cms">
                                <span class="pill-label">CMS Integration</span>
                                <span class="feature-desc">Update content yourself via WordPress or a headless CMS.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="ecommerce">
                                <span class="pill-label">E‑commerce</span>
                                <span class="feature-desc">Product catalog, cart, and checkout.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="analytics">
                                <span class="pill-label">Analytics</span>
                                <span class="feature-desc">GA4 setup and basic event tracking.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="performance">
                                <span class="pill-label">Performance</span>
                                <span class="feature-desc">Core Web Vitals tuning.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="accessibility">
                                <span class="pill-label">Accessibility</span>
                                <span class="feature-desc">WCAG‑friendly patterns and checks.</span>
                            </label>
                            <label class="feature-pill">
                                <input type="checkbox" name="features" value="multilanguage">
                                <span class="pill-label">Multi‑language</span>
                                <span class="feature-desc">Localized content and language switcher.</span>
                            </label>
                        </div>
                    </div>
                </section>

                <!-- STEP 4: Options (timeline, maintenance, discount, payment) -->
                <section class="calculator-step" id="step-options" aria-labelledby="lbl-options">
                    <div class="form-group" id="sec-timeline">
                        <label id="lbl-options">Timeline</label>
                        <div class="maintenance-row">
                            <label class="feature-pill small">
                                <input type="radio" name="timeline" value="standard" checked>
                                <span class="pill-label">Standard</span>
                            </label>
                            <label class="feature-pill small">
                                <input type="radio" name="timeline" value="express">
                                <span class="pill-label">Express (+20%)</span>
                            </label>
                            <label class="feature-pill small">
                                <input type="radio" name="timeline" value="rush">
                                <span class="pill-label">Rush (+50%)</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group" id="sec-maintenance">
                        <label>Maintenance</label>
                        <div class="maintenance-row">
                            <label class="feature-pill small">
                                <input type="radio" name="maintenance" value="none" checked>
                                <span class="pill-label">None</span>
                            </label>
                            <label class="feature-pill small">
                                <input type="radio" name="maintenance" value="basic">
                                <span class="pill-label">Basic ($30/mo)</span>
                            </label>
                            <label class="feature-pill small">
                                <input type="radio" name="maintenance" value="pro">
                                <span class="pill-label">Managed ($120/mo)</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group" id="sec-discount">
                        <label for="discount-code">Discount code</label>
                        <div class="discount-row">
                            <input type="text" id="discount-code" name="discount_code" placeholder="Enter code (e.g., SAVE10)">
                            <button type="button" id="apply-discount" class="btn btn-secondary">Apply</button>
                        </div>
                    </div>
                    <div class="form-group" id="sec-payment">
                        <div class="payment-row">
                            <input type="checkbox" id="show-monthly" name="show_monthly">
                            <label for="show-monthly">Show estimated monthly (12 months)</label>
                        </div>
                    </div>
                </section>

                <!-- STEP 5: Quote -->
                        <section class="calculator-step" id="step-quote" aria-live="polite">
                            <aside id="cost-result" class="cost-result-container">
                        <div class="skeleton-line"></div>
                        <div class="skeleton-line short"></div>
                    </aside>
                    <div class="quote-actions">
                        <button type="button" id="send-quote-btn" class="btn btn-primary" disabled aria-disabled="true">Email this Quote</button>
                        <button type="button" id="contact-us" class="btn btn-secondary" onclick="scrollToSection('contact')">Contact Us</button>
                    </div>

                    <!-- ROI after estimate -->
                    <section id="roi-section" class="roi-section" hidden>
                        <div class="roi-header">
                            <h4>Potential ROI</h4>
                            <p class="muted">Estimate how many new customers it takes to break even.</p>
                        </div>
                        <div class="roi-body">
                            <p class="compact">Average profit per new customer</p>
                            <div class="roi-input-row">
                                <span class="currency-prefix">$</span>
                                <input type="number" id="roi-customer-value" min="1" step="1" placeholder="e.g., 200">
                                <button type="button" id="roi-calc" class="btn btn-secondary">Calculate ROI</button>
                            </div>
                            <div id="roi-output" class="roi-output" aria-live="polite"></div>
                        </div>
                    </section>
                </section>

                <!-- Wizard navigation -->
            <div class="calculator-navigation">
                    <button type="button" id="prev-step-btn" class="btn btn-secondary">Back</button>
                    <button type="button" id="next-step-btn" class="btn btn-primary">Next Step</button>
                </div>
            </form>
        </div>

        <!-- Sticky bottom action bar -->
        <div class="calc-bottom-bar">
            <span class="bar-hint">Your estimate updates as you go.</span>
            <div class="bar-actions">
                <button type="button" id="calculator-close-bottom" class="btn btn-secondary">Close</button>
                <button type="button" id="calculator-calc-bottom" class="btn btn-primary btn-lg">Calculate</button>
            </div>
        </div>
    </div>
</div>
